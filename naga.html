<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Naga | Instinct</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      :root {
        --bg: #000000;
        --text: #ffffff;
        --muted: #555;
        --accent: #ff3b3b;
        --title-grad: linear-gradient(90deg, #ffffff 0%, #333333 100%);
      }

      * {
        box-sizing: border-box;
        font-family: "Inter", sans-serif;
      }

      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        background-color: var(--bg);
        color: var(--text);
        overflow: hidden;
      }

      /* PHOTO-ACCURATE BACKGROUND & VIGNETTE */
      .bg-layer {
        position: fixed;
        inset: 0;
        z-index: -1;
        background:
          radial-gradient(
            circle at center,
            transparent 0%,
            rgba(0, 0, 0, 1) 90%
          ),
          url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMiIgY3k9IjIiIHI9IjEiIGZpbGw9IiMxYjFiMWIiLz48L3N2Zz4=");
      }

      /* ================= NAVBAR ================= */
      .navbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 90px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 60px;
        z-index: 100;
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 1) 0%,
          transparent 100%
        );
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 1.3rem;
        font-weight: 800;
        letter-spacing: -1px;
      }

      .nav-links {
        display: flex;
        gap: 30px;
      }
      .nav-links button {
        background: none;
        border: none;
        color: var(--muted);
        cursor: pointer;
        font-size: 0.85rem;
        font-weight: 500;
        transition: 0.3s;
      }
      .nav-links button:hover {
        color: #fff;
      }

      .play-now-btn {
        background: transparent;
        color: #fff;
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 10px 22px;
        border-radius: 10px;
        font-size: 0.85rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: 0.3s;
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);
      }
      .play-now-btn:hover:not(:disabled) {
        background: #fff;
        color: #000;
        box-shadow: 0 0 25px rgba(255, 255, 255, 0.2);
      }
      .play-now-btn:disabled {
        opacity: 0.3;
        cursor: not-allowed;
      }

      /* ================= SCREENS ================= */
      .screen {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 40px;
        z-index: 50;
      }
      .hidden {
        display: none !important;
      }

      .hero-title {
        font-size: clamp(2.5rem, 6vw, 4.5rem);
        font-weight: 800;
        line-height: 1.1;
        margin-bottom: 20px;
        letter-spacing: -2px;
        background: var(--title-grad);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .hero-sub {
        max-width: 500px;
        color: #666;
        line-height: 1.6;
        font-size: 0.95rem;
        margin-bottom: 40px;
      }

      /* ================= GAME ELEMENTS ================= */
      #game-container {
        position: absolute;
        top: 100px; /* Below Navbar */
        bottom: 40px;
        left: 40px;
        right: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      canvas {
        image-rendering: pixelated;
      }

      .hud {
        position: fixed;
        bottom: 30px;
        width: 100%;
        text-align: center;
        font-size: 0.7rem;
        color: #444;
        text-transform: uppercase;
        letter-spacing: 4px;
        z-index: 60;
      }

      .pause-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(8px);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 150;
      }
      .pause-text {
        font-size: 4rem;
        font-weight: 900;
        letter-spacing: 15px;
        margin-bottom: 10px;
      }

      .countdown {
        font-size: 5rem;
        font-weight: 900;
        color: #fff;
      }

      .dev-badge {
        position: fixed;
        top: 110px;
        right: 60px;
        border: 1px solid #fff;
        padding: 4px 12px;
        font-size: 0.6rem;
        border-radius: 4px;
        font-weight: 700;
        z-index: 100;
      }
    </style>
  </head>
  <body>
    <div class="bg-layer"></div>

    <div class="navbar">
      <div class="brand">Naga</div>
      <div class="nav-links">
        <button onclick="showScreen('how')">How to play</button>
        <button onclick="showScreen('leaderboard')">Leaderboard</button>
        <button onclick="showScreen('about')">About</button>
      </div>
      <button class="play-now-btn" id="navPlayBtn" onclick="startGame()">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
          <path d="M8 5v14l11-7z" />
        </svg>
        Play Now
      </button>
    </div>

    <div class="screen" id="start">
      <h1 class="hero-title">You Grew Up. Snake<br />Didn't. Play It Again.</h1>
      <p class="hero-sub">
        No fluff, no noise. Just you, the grid, and the growing tail.
      </p>
      <button
        class="play-now-btn"
        style="padding: 15px 35px"
        onclick="startGame()"
      >
        ▶ Start Engine
      </button>
    </div>

    <div class="screen hidden" id="over">
      <h1 class="hero-title">Defeat.</h1>
      <p id="final-score" class="hero-sub"></p>
      <button
        class="play-now-btn"
        style="padding: 15px 35px"
        onclick="startGame()"
      >
        Try Again
      </button>
    </div>

    <div id="game-container">
      <canvas id="game"></canvas>
    </div>

    <div class="hud" id="hud"></div>

    <div class="pause-overlay hidden" id="pauseOverlay">
      <div class="pause-text" id="pauseLabel">PAUSED</div>
      <div class="countdown hidden" id="timer">3</div>
    </div>

    <div id="dev-tag" class="dev-badge hidden">DEV MODE ENABLED</div>

    <script>
      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");

      let snake, dir, food, loop, score;
      let speed = 120;
      let paused = false;
      let devMode = false;
      let isCountingDown = false;
      let pr = localStorage.getItem("naga_pr") || 0;

      const GRID_X = 40;
      const GRID_Y = 22;

      function resize() {
        const container = document.getElementById("game-container");
        const availableW = container.clientWidth;
        const availableH = container.clientHeight;
        const cellSize = Math.min(availableW / GRID_X, availableH / GRID_Y);

        canvas.width = cellSize * GRID_X;
        canvas.height = cellSize * GRID_Y;
      }
      window.addEventListener("resize", resize);
      resize();

      function showScreen(id) {
        document
          .querySelectorAll(".screen")
          .forEach((s) => s.classList.add("hidden"));
        if (id !== "none")
          document.getElementById(id).classList.remove("hidden");
      }

      function startGame() {
        showScreen("none");
        snake = [
          { x: 10, y: 10 },
          { x: 9, y: 10 },
          { x: 8, y: 10 },
        ];
        dir = { x: 1, y: 0 };
        food = { x: 20, y: 10 };
        score = 0;
        speed = 120;
        paused = false;
        devMode = false;
        document.getElementById("pauseOverlay").classList.add("hidden");
        document.getElementById("dev-tag").classList.add("hidden");
        document.getElementById("navPlayBtn").disabled = false;
        resetInterval();
      }

      function resetInterval() {
        clearInterval(loop);
        loop = setInterval(tick, speed);
      }

      function tick() {
        if (paused || isCountingDown) return;
        const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };
        if (
          head.x < 0 ||
          head.x >= GRID_X ||
          head.y < 0 ||
          head.y >= GRID_Y ||
          snake.some((s) => s.x === head.x && s.y === head.y)
        )
          return endGame();

        snake.unshift(head);
        if (head.x === food.x && head.y === food.y) {
          score++;
          if (!devMode) {
            speed = Math.max(50, speed - 2);
            resetInterval();
          }
          food = {
            x: Math.floor(Math.random() * GRID_X),
            y: Math.floor(Math.random() * GRID_Y),
          };
        } else snake.pop();
        draw();
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const cw = canvas.width / GRID_X;
        const ch = canvas.height / GRID_Y;

        // Draw Dot Grid with Spaces
        ctx.fillStyle = "rgba(255,255,255,0.03)";
        for (let i = 0; i < GRID_X; i++) {
          for (let j = 0; j < GRID_Y; j++) {
            ctx.fillRect(i * cw + 2, j * ch + 2, cw - 4, ch - 4);
          }
        }

        // Food
        ctx.fillStyle = "#ff3b3b";
        ctx.fillRect(food.x * cw + 2, food.y * ch + 2, cw - 4, ch - 4);

        // Snake with Tail Fade
        snake.forEach((s, i) => {
          const opacity = 1 - i / (snake.length + 2);
          ctx.fillStyle = `rgba(255,255,255,${opacity})`;
          ctx.fillRect(s.x * cw + 1, s.y * ch + 1, cw - 2, ch - 2);
        });

        document.getElementById("hud").innerText =
          `SCORE ${score}  —  BEST ${pr} ${devMode ? ` — DEV SPEED ${speed}ms` : ""}`;
      }

      function togglePause(isDev = false) {
        if (paused) {
          startCountdown();
        } else {
          paused = true;
          if (isDev) {
            devMode = true;
            speed = 400; // Auto-slow for dev
            resetInterval();
            document.getElementById("dev-tag").classList.remove("hidden");
          }
          document.getElementById("pauseOverlay").classList.remove("hidden");
          document.getElementById("pauseLabel").classList.remove("hidden");
          document.getElementById("timer").classList.add("hidden");
          document.getElementById("navPlayBtn").disabled = true;
        }
      }

      function startCountdown() {
        isCountingDown = true;
        document.getElementById("pauseLabel").classList.add("hidden");
        const timerEl = document.getElementById("timer");
        timerEl.classList.remove("hidden");
        let count = 3;
        timerEl.innerText = count;

        const interval = setInterval(() => {
          count--;
          if (count > 0) {
            timerEl.innerText = count;
          } else {
            clearInterval(interval);
            paused = false;
            isCountingDown = false;
            document.getElementById("pauseOverlay").classList.add("hidden");
            document.getElementById("navPlayBtn").disabled = false;
            resetInterval();
          }
        }, 600);
      }

      function endGame() {
        clearInterval(loop);
        if (score > pr) {
          pr = score;
          localStorage.setItem("naga_pr", pr);
        }
        document.getElementById("final-score").innerText =
          `Score ${score} · Best ${pr}`;
        showScreen("over");
      }

      window.addEventListener("keydown", (e) => {
        const k = e.key.toLowerCase();
        if (k === "p") togglePause(true);
        if (k === "escape" || k === " " || k === "enter") togglePause(false);

        if (devMode && !paused) {
          if (k === "[") {
            speed += 50;
            resetInterval();
          }
          if (k === "]") {
            speed = Math.max(10, speed - 50);
            resetInterval();
          }
        }

        if ((k === "arrowup" || k === "w") && dir.y === 0)
          dir = { x: 0, y: -1 };
        if ((k === "arrowdown" || k === "s") && dir.y === 0)
          dir = { x: 0, y: 1 };
        if ((k === "arrowleft" || k === "a") && dir.x === 0)
          dir = { x: -1, y: 0 };
        if ((k === "arrowright" || k === "d") && dir.x === 0)
          dir = { x: 1, y: 0 };
      });

      showScreen("start");
    </script>
  </body>
</html>
